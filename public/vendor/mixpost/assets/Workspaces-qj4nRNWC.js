import{u as N,i as j,a6 as X,C as M,q as T,o as r,c as g,e as y,v as D,b as s,g as h,w as t,a as e,U as q,a0 as Y,f as d,t as p,V as ee,a1 as O,a5 as R,n as z,G as U,l as I,z as te,ab as B,F as P,r as G,H as se,j as C,p as oe,L as ae,R as re,S as E,d as le,Z as ne,h as ce,k as ie,a8 as A}from"./app-BxavtTYs.js";import{u as ue}from"./useSelectable-BJ_lcm9V.js";import{_ as me}from"./Admin-CpLrPT1Z.js";import{_ as de}from"./PageHeader-BnI1hV_t.js";import{_ as pe}from"./PureDangerButton-zhKtSmpI.js";import{_ as fe}from"./Panel-Lw-nuda0.js";import{_ as F}from"./Checkbox-CKdbYkOi.js";import{_ as i,a as H,T as _e}from"./TableCell-C46VQBCN.js";import{_ as ke}from"./SelectableBar-CA2MAe5u.js";import{_ as we}from"./NoResult-DNS5zprA.js";import{T as Z}from"./Trash-B9tkDRbU.js";import{_ as he}from"./Pagination-CB2UcsG3.js";import{_ as L}from"./PureButtonLink-hEv16skr.js";import{E as ge}from"./Eye-hTbiOyAR.js";import{_ as $e}from"./DropdownButton-DyMVBGMY.js";import{A as ve}from"./ArrowTopRightOnSquare-IL6rJNOT.js";import{_ as be}from"./SearchInput-CkdofEcO.js";import{_ as ye}from"./Alert-BlT5orGN.js";import{_ as Ce}from"./Flex-0eM5h-qJ.js";import"./QueueList-CJbQdoC3.js";import"./ChevronLeft-C0HP3zNo.js";import"./EllipsisVertical-DCDthPML.js";const xe={class:"flex flex-row items-center justify-end gap-xs"},Ve={__name:"WorkspaceItemAction",props:{itemId:{type:String,required:!0}},emits:["onDelete"],setup(o,{emit:a}){const{t:l}=N(),c=j("routePrefix"),_=j("confirmation"),$=o,v=a,{notify:k}=z();X();const f=M(!1),x=()=>{_().title(l("workspace.delete_workspace")).description(l("workspace.confirm_delete_workspace")).destructive().onConfirm(u=>{u.isLoading(!0),O.delete(route(`${c}.workspaces.delete`,{workspace:$.itemId}),{onSuccess(){f.value=!1,k("success",l("workspace.workspace_deleted")),v("onDelete"),R.emit("workspaceDelete",$.itemId),u.reset()},onFinish(){u.isLoading(!1)}})}).show()};return(u,S)=>{const b=T("tooltip");return r(),g("div",null,[y("div",xe,[D((r(),h(L,{href:u.route("mixpost.switchWorkspace",{workspace:o.itemId,redirect:!0}),method:"post",as:"button",type:"button"},{default:t(()=>[e(ve)]),_:1},8,["href"])),[[b,s(l)("general.open")]]),D((r(),h(L,{href:u.route(`${s(c)}.workspaces.view`,{workspace:o.itemId})},{default:t(()=>[e(ge)]),_:1},8,["href"])),[[b,s(l)("general.view")]]),e(ee,{placement:"bottom-end"},{trigger:t(()=>[e($e)]),content:t(()=>[e(q,{href:u.route(`${s(c)}.workspaces.edit`,{workspace:o.itemId})},{icon:t(()=>[e(Y)]),default:t(()=>[d(" "+p(s(l)("general.edit")),1)]),_:1},8,["href"]),e(q,{onClick:x,as:"button"},{icon:t(()=>[e(Z,{class:"text-red-500"})]),default:t(()=>[d(" "+p(s(l)("general.delete")),1)]),_:1})]),_:1})])])}}},Ie={key:0,class:"flex justify-start"},je={key:0,class:"mt-xs"},De={__name:"WorkspaceItem",props:{item:{type:Object,required:!0}},setup(o){const a=o,l=U(()=>I.sortBy(a.item.users.slice(0,3),"pivot.joined_at")),c=U(()=>a.item.users.slice(3).length);return(_,$)=>{const v=T("tooltip");return r(),h(H,{hoverable:!0},{default:t(()=>[e(i,{class:"w-10"},{default:t(()=>[te(_.$slots,"checkbox")]),_:3}),e(i,null,{default:t(()=>[e(B,{backgroundColor:o.item.hex_color,name:o.item.name,roundedClass:"rounded-lg"},null,8,["backgroundColor","name"])]),_:1}),e(i,null,{default:t(()=>[y("div",null,p(o.item.name),1)]),_:1}),e(i,null,{default:t(()=>[d(p(o.item.created_at),1)]),_:1}),e(i,null,{default:t(()=>[o.item.users.length?(r(),g("div",Ie,[(r(!0),g(P,null,G(l.value,(k,f)=>D((r(),h(B,{key:k.id,name:k.name,class:se([{"-ml-6":f>0},"cursor-default mr-xs last:mr-xs"])},null,8,["name","class"])),[[v,k.name]])),128)),c.value?(r(),g("div",je," +"+p(c.value),1)):C("",!0)])):C("",!0)]),_:1}),e(i,null,{default:t(()=>[e(Ve,{itemId:o.item.uuid},null,8,["itemId"])]),_:1})]),_:3})}}},Se={class:"flex items-center"},Oe={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(o,{emit:a}){return U(()=>0),(l,c)=>(r(),g("div",Se,[e(be,{modelValue:o.modelValue.keyword,"onUpdate:modelValue":c[0]||(c[0]=_=>o.modelValue.keyword=_),placeholder:l.$t("general.search")},null,8,["modelValue","placeholder"])]))}},Re={class:"w-full mx-auto row-py"},Ue={class:"mt-lg row-px w-full"},Pe=["href"],Te={key:1,class:"mt-lg"},We=le({layout:me}),rt=Object.assign(We,{__name:"Workspaces",props:{workspaces:{type:Object},filter:{type:Object,default:{}}},setup(o){const{t:a}=N(),l=j("routePrefix"),c=o,_=a("workspace.workspaces"),$=j("confirmation"),{notify:v}=z(),{enterpriseConsole:k}=oe(),{selectedRecords:f,putPageRecords:x,toggleSelectRecordsOnPage:u,deselectRecord:S,deselectAllRecords:b}=ue(),W=()=>c.workspaces.data.map(n=>n.uuid),V=M({keyword:c.filter.keyword});ae(()=>{x(W()),R.on("workspaceDelete",n=>{S(n)})}),re(()=>{R.off("workspaceDelete")}),E(()=>c.workspaces.data,()=>{x(W())}),E(()=>I.cloneDeep(V.value),I.throttle(()=>{O.get(route(`${l}.workspaces.index`),I.pickBy(V.value),{preserveState:!0,only:["workspaces","filter"]})},300));const J=()=>{$().title(a("workspace.delete_workspaces")).description(a("workspace.confirm_delete_workspaces")).destructive().onConfirm(n=>{n.isLoading(!0),O.delete(route(`${l}.workspaces.deleteMultiple`),{data:{workspaces:f.value},preserveScroll:!0,onSuccess(){b(),v("success",a("workspace.workspaces_deleted"))},onFinish(){n.reset()}})}).show()};return(n,m)=>{const K=T("tooltip");return r(),g(P,null,[e(s(ne),{title:s(_)},null,8,["title"]),y("div",Re,[e(de,{title:s(_)},{description:t(()=>[d(p(s(a)("workspace.manage_brands_businesses")),1)]),_:1},8,["title"]),y("div",Ue,[e(ke,{count:s(f).length,onClose:s(b)},{default:t(()=>[D((r(),h(pe,{onClick:J},{default:t(()=>[e(Z)]),_:1})),[[K,s(a)("general.delete")]])]),_:1},8,["count","onClose"]),s(k).url?(r(),h(ye,{key:0,variant:"warning",closeable:!1,class:"mb-lg"},{default:t(()=>[m[3]||(m[3]=d(" Manage Workspaces from the ")),y("a",{href:`${s(k).url}/workspaces`,class:"link"},"Enterprise Console",8,Pe),m[4]||(m[4]=d(" for more business actions. "))]),_:1})):C("",!0),e(Ce,{class:"justify-between"},{default:t(()=>[e(s(ce),{href:n.route(`${s(l)}.workspaces.create`),class:"mb-xs sm:mb-0"},{default:t(()=>[e(ie,null,{default:t(()=>[d(p(s(a)("workspace.create_workspace")),1)]),_:1})]),_:1},8,["href"]),e(Oe,{modelValue:V.value,"onUpdate:modelValue":m[0]||(m[0]=w=>V.value=w)},null,8,["modelValue"])]),_:1}),e(fe,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(_e,null,{head:t(()=>[e(H,null,{default:t(()=>[e(i,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(F,{checked:s(u),"onUpdate:checked":m[1]||(m[1]=w=>A(u)?u.value=w:null),disabled:!n.$page.props.workspaces.meta.total},null,8,["checked","disabled"])]),_:1}),e(i,{component:"th",scope:"col"}),e(i,{component:"th",scope:"col"},{default:t(()=>[d(p(s(a)("general.name")),1)]),_:1}),e(i,{component:"th",scope:"col"},{default:t(()=>[d(p(s(a)("general.created_at")),1)]),_:1}),e(i,{component:"th",scope:"col"},{default:t(()=>[d(p(s(a)("user.users")),1)]),_:1}),e(i,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(r(!0),g(P,null,G(n.$page.props.workspaces.data,w=>(r(),h(De,{key:w.uuid,item:w,onOnDelete:()=>{s(S)(w.uuid)}},{checkbox:t(()=>[e(F,{checked:s(f),"onUpdate:checked":m[2]||(m[2]=Q=>A(f)?f.value=Q:null),value:w.uuid},null,8,["checked","value"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),n.$page.props.workspaces.meta.total?C("",!0):(r(),h(we,{key:0,table:""}))]),_:1}),n.$page.props.workspaces.meta.links.length>3?(r(),g("div",Te,[e(he,{meta:n.$page.props.workspaces.meta,links:n.$page.props.workspaces.links},null,8,["meta","links"])])):C("",!0)])])],64)}}});export{rt as default};
