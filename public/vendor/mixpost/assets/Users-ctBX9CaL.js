import{u as B,i as x,a6 as F,C as E,q as L,o,c as v,e as V,v as A,b as s,g as p,w as t,a as e,U as P,a0 as J,f as m,t as i,j as I,V as K,a1 as C,a5 as S,z as Q,ab as W,a3 as X,G as Y,L as ee,R as te,S as R,l as j,F as N,d as se,Z as ae,h as le,k as re,a8 as T,r as oe,n as ne}from"./app-BxavtTYs.js";import{_ as ie}from"./Admin-CpLrPT1Z.js";import{u as ue}from"./useSelectable-BJ_lcm9V.js";import{_ as ce}from"./PageHeader-BnI1hV_t.js";import{_ as de}from"./PureDangerButton-zhKtSmpI.js";import{_ as me}from"./Panel-Lw-nuda0.js";import{_ as q}from"./Checkbox-CKdbYkOi.js";import{_ as n,a as M,T as fe}from"./TableCell-C46VQBCN.js";import{_ as _e}from"./PureButtonLink-hEv16skr.js";import{E as pe}from"./Eye-hTbiOyAR.js";import{T as z}from"./Trash-B9tkDRbU.js";import{_ as he}from"./DropdownButton-DyMVBGMY.js";import{_ as $e}from"./SelectableBar-CA2MAe5u.js";import{_ as ve}from"./NoResult-DNS5zprA.js";import{_ as ke}from"./Pagination-CB2UcsG3.js";import{_ as ge}from"./SearchInput-CkdofEcO.js";import{_ as be}from"./Flex-0eM5h-qJ.js";import"./QueueList-CJbQdoC3.js";import"./EllipsisVertical-DCDthPML.js";import"./ChevronLeft-C0HP3zNo.js";const ye={class:"flex flex-row items-center justify-end gap-xs"},we={__name:"UserItemAction",props:{itemId:{type:Number,required:!0}},emits:["onDelete"],setup(a,{emit:l}){const{t:r}=B(),u=x("routePrefix"),h=x("confirmation"),k=a,D=l,{user:g}=F(),_=E(!1),b=()=>{h().title(r("user.delete_user")).description(r("user.confirm_delete_user")).destructive().onConfirm(c=>{c.isLoading(!0),C.delete(route(`${u}.users.delete`,{user:k.itemId}),{onSuccess(){_.value=!1,D("onDelete"),S.emit("userDelete",k.itemId),c.reset()},onFinish(){c.close()}})}).show()};return(c,U)=>{const y=L("tooltip");return o(),v("div",null,[V("div",ye,[A((o(),p(_e,{href:c.route(`${s(u)}.users.view`,{user:a.itemId})},{default:t(()=>[e(pe)]),_:1},8,["href"])),[[y,s(r)("general.view")]]),e(K,{placement:"bottom-end"},{trigger:t(()=>[e(he)]),content:t(()=>[e(P,{href:c.route(`${s(u)}.users.edit`,{user:a.itemId})},{icon:t(()=>[e(J)]),default:t(()=>[m(" "+i(s(r)("general.edit")),1)]),_:1},8,["href"]),s(g).id!==a.itemId?(o(),p(P,{key:0,onClick:b,as:"button"},{icon:t(()=>[e(z,{class:"text-red-500"})]),default:t(()=>[m(" "+i(s(r)("general.delete")),1)]),_:1})):I("",!0)]),_:1})])])}}},xe={__name:"UserItem",props:{item:{type:Object,required:!0}},setup(a){return(l,r)=>(o(),p(M,{hoverable:!0},{default:t(()=>[e(n,{class:"w-10"},{default:t(()=>[Q(l.$slots,"checkbox")]),_:3}),e(n,null,{default:t(()=>[e(W,{name:a.item.name},null,8,["name"])]),_:1}),e(n,null,{default:t(()=>[V("div",null,i(a.item.name),1),a.item.is_admin?(o(),p(X,{key:0,class:"mt-xs"},{default:t(()=>[m(i(l.$t("user.system_admin")),1)]),_:1})):I("",!0)]),_:1}),e(n,null,{default:t(()=>[m(i(a.item.email),1)]),_:1}),e(n,null,{default:t(()=>[m(i(a.item.created_at),1)]),_:1}),e(n,null,{default:t(()=>[e(we,{itemId:a.item.id},null,8,["itemId"])]),_:1})]),_:3}))}},Ve={class:"flex items-center"},Ie={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(a,{emit:l}){return Y(()=>0),(r,u)=>(o(),v("div",Ve,[e(ge,{modelValue:a.modelValue.keyword,"onUpdate:modelValue":u[0]||(u[0]=h=>a.modelValue.keyword=h),placeholder:r.$t("general.search")},null,8,["modelValue","placeholder"])]))}},De={class:"w-full mx-auto row-py"},Ue={class:"mt-lg row-px w-full"},je={key:0,class:"mt-lg"},Ce=se({layout:ie}),We=Object.assign(Ce,{__name:"Users",props:{users:{type:Object},filter:{type:Object,default:{}}},setup(a){const{t:l}=B(),r=x("routePrefix"),u=a,h=l("user.users"),{notify:k}=ne(),D=x("confirmation"),{user:g}=F(),{selectedRecords:_,putPageRecords:b,toggleSelectRecordsOnPage:c,deselectRecord:U,deselectAllRecords:y}=ue(),O=()=>u.users.data.filter(d=>d.id!==g.value.id).map(d=>d.id),w=E({keyword:u.filter.keyword});ee(()=>{b(O()),S.on("userDelete",d=>{U(d)})}),te(()=>{S.off("userDelete")}),R(()=>u.users.data,()=>{b(O())}),R(()=>j.cloneDeep(w.value),j.throttle(()=>{C.get(route(`${r}.users.index`),j.pickBy(w.value),{preserveState:!0,only:["users","filter"]})},300));const G=()=>{D().title(l("user.delete_users")).description(l("user.confirm_delete_users")).destructive().onConfirm(d=>{d.isLoading(!0),C.delete(route(`${r}.users.deleteMultiple`),{data:{users:_.value},preserveScroll:!0,onSuccess(){y(),k("success",l("user.selected_users_deleted"))},onFinish(){d.reset()}})}).show()};return(d,$)=>{const Z=L("tooltip");return o(),v(N,null,[e(s(ae),{title:s(h)},null,8,["title"]),V("div",De,[e(ce,{title:s(h)},{description:t(()=>[m(i(s(l)("user.manage_users")),1)]),_:1},8,["title"]),V("div",Ue,[e($e,{count:s(_).length,onClose:s(y)},{default:t(()=>[A((o(),p(de,{onClick:G},{default:t(()=>[e(z)]),_:1})),[[Z,s(l)("general.delete")]])]),_:1},8,["count","onClose"]),e(be,{class:"justify-between"},{default:t(()=>[e(s(le),{href:d.route(`${s(r)}.users.create`),class:"mb-xs sm:mb-0"},{default:t(()=>[e(re,null,{default:t(()=>[m(i(s(l)("user.create_user")),1)]),_:1})]),_:1},8,["href"]),e(Ie,{modelValue:w.value,"onUpdate:modelValue":$[0]||($[0]=f=>w.value=f)},null,8,["modelValue"])]),_:1}),e(me,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(fe,null,{head:t(()=>[e(M,null,{default:t(()=>[e(n,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(q,{checked:s(c),"onUpdate:checked":$[1]||($[1]=f=>T(c)?c.value=f:null),disabled:!a.users.meta.total},null,8,["checked","disabled"])]),_:1}),e(n,{component:"th",scope:"col"}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.name")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.email")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.created_at")),1)]),_:1}),e(n,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(o(!0),v(N,null,oe(a.users.data,f=>(o(),p(xe,{key:f.id,item:f,onOnDelete:()=>{s(U)(f.id)}},{checkbox:t(()=>[e(q,{checked:s(_),"onUpdate:checked":$[2]||($[2]=H=>T(_)?_.value=H:null),value:f.id,disabled:f.id===s(g).id,number:""},null,8,["checked","value","disabled"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),a.users.meta.total?I("",!0):(o(),p(ve,{key:0,table:""}))]),_:1}),a.users.meta.links.length>3?(o(),v("div",je,[e(ke,{meta:a.users.meta,links:a.users.links},null,8,["meta","links"])])):I("",!0)])])],64)}}});export{We as default};
