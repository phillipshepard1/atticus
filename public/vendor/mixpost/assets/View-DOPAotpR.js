import{i as b,C,l as B,a4 as J,o as f,c as V,a as t,w as e,f as r,t as o,u as P,T as D,P as K,b as a,s as U,k as A,O as E,F as S,n as L,q as Q,g as x,r as X,e as k,ab as Y,a3 as j,v as ee,V as te,U as T,a0 as q,a1 as F,j as ae,d as se,Z as oe,h as z,x as le,_ as N,ac as re}from"./app-BxavtTYs.js";import{_ as ne}from"./Admin-CpLrPT1Z.js";import{_ as ce}from"./PageHeader-BnI1hV_t.js";import{_ as O}from"./Panel-Lw-nuda0.js";import{T as I}from"./Trash-B9tkDRbU.js";import{_ as ie}from"./NoResult-DNS5zprA.js";import{_ as ue}from"./DropdownButton-DyMVBGMY.js";import{a as R,_ as d,T as de}from"./TableCell-C46VQBCN.js";import{_ as W,a as M}from"./CanApprove-Ppwv2_eW.js";import{E as me}from"./Eye-hTbiOyAR.js";import{_ as pe}from"./PureButtonLink-hEv16skr.js";import{_ as Z}from"./VerticalGroup-DHZRXNYR.js";import{A as fe}from"./ArrowTopRightOnSquare-IL6rJNOT.js";import{_ as _e}from"./ClipboardCard-COMTvcXc.js";import"./QueueList-CJbQdoC3.js";import"./Flex-0eM5h-qJ.js";import"./EllipsisVertical-DCDthPML.js";import"./Radio-BACqEdPU.js";import"./Checkbox-CKdbYkOi.js";import"./ClipboardButton-zAZn9sLi.js";import"./Clipboard-D9JxKoAX.js";const ke={class:"relative"},we={__name:"SelectUser",props:{modelValue:{default:null},users:{type:Array,default:[]},exclude:{type:Array,default:[]},filter:{type:Object,default:{}}},emits:["update:modelValue"],setup(n,{emit:s}){const w=n,y=b("routePrefix"),m=C(w.users),c=(l,p)=>{l&&(p(!0),h(p,l))},h=B.throttle((l,p)=>{axios.get(route(`${y}.users.resources.items`),{params:Object.assign({keyword:p,exclude:w.exclude},w.filter)}).then(_=>{l(!1),m.value=_.data.data.map(v=>({key:v.id,label:v.name}))})},350);return(l,p)=>{const _=J("v-select");return f(),V("div",ke,[t(_,{modelValue:n.modelValue,"onUpdate:modelValue":p[0]||(p[0]=v=>l.$emit("update:modelValue",v)),options:m.value,filterable:!1,"close-on-select":!0,placeholder:l.$t("user.type_search_user"),onSearch:c},{"no-options":e(({search:v,searching:g,loading:i})=>[r(o(l.$t("general.list_empty")),1)]),_:1},8,["modelValue","options","placeholder"])])}}},he={__name:"AttachUser",props:{workspace:{type:Object},attachedUsers:{type:Array,default:[]}},setup(n){const{t:s}=P(),{notify:w}=L(),y=n,m=C(null),c=D({user_id:null,role:"admin",can_approve:!1}),h=()=>{c.transform(v=>({...v,user_id:m.value.key})).post(route("mixpost.workspaces.users.store",{workspace:y.workspace.uuid}),{preserveScroll:!0,onSuccess(){_(),c.reset(),w("success",s("team.user_attached"))}})},l=C(!1),p=()=>{l.value=!0},_=()=>{l.value=!1,m.value=null};return(v,g)=>(f(),V(S,null,[t(U,{onClick:p,size:"sm"},{icon:e(()=>[t(K)]),default:e(()=>[r(" "+o(a(s)("team.attach")),1)]),_:1}),t(E,{show:l.value,"max-width":"md","scrollable-body":!0,closeable:!0,onClose:_},{header:e(()=>[r(o(a(s)("team.attach_user")),1)]),body:e(()=>[t(we,{modelValue:m.value,"onUpdate:modelValue":g[0]||(g[0]=i=>m.value=i),exclude:n.attachedUsers},null,8,["modelValue","exclude"]),t(W,{modelValue:a(c).role,"onUpdate:modelValue":g[1]||(g[1]=i=>a(c).role=i),class:"mt-lg"},null,8,["modelValue"]),t(Z,{class:"mt-lg"},{default:e(()=>[t(M,{modelValue:a(c).can_approve,"onUpdate:modelValue":g[2]||(g[2]=i=>a(c).can_approve=i)},null,8,["modelValue"])]),_:1})]),footer:e(()=>[t(U,{onClick:_,class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[r(o(a(s)("general.cancel")),1)]),_:1}),t(A,{onClick:h,disabled:!m.value||a(c).processing,isLoading:a(c).processing},{default:e(()=>[r(o(a(s)("team.attach")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])],64))}},ve={class:"flex justify-start"},ge={class:"capitalize"},$e={class:"flex justify-end"},ye={class:"font-medium"},xe={__name:"WorkspaceUsers",props:{workspace:{type:Object}},setup(n){const{t:s}=P(),w=b("routePrefix"),y=b("confirmation"),{notify:m}=L(),c=n,h=C(null),l=D({user_id:null,role:"admin",can_approve:!1}),p=i=>{l.user_id=i.id,l.role=i.pivot.role,l.can_approve=i.pivot.can_approve,h.value=i},_=()=>{h.value=null,l.reset()},v=i=>{y().title("Detach user").description(`Are you sure you want to detach <strong>${i.name}</strong> from <strong>${c.workspace.name}</strong>?`).destructive().btnConfirmName(s("general.detach")).onConfirm($=>{$.isLoading(!0),F.delete(route("mixpost.workspaces.users.delete",{workspace:c.workspace.uuid}),{data:{user_id:i.id},preserveScroll:!0,onSuccess(){$.reset(),m("success",s("team.user_detached"))},onFinish(){$.isLoading(!1)}})}).show()},g=()=>{l.put(route("mixpost.workspaces.users.update",{workspace:c.workspace.uuid}),{preserveScroll:!0,onSuccess(){l.reset(),_(),m("success",s("team.role_updated"))}})};return(i,$)=>{const G=Q("tooltip");return f(),V(S,null,[t(O,null,{title:e(()=>[r(o(a(s)("user.users")),1)]),action:e(()=>[t(he,{workspace:n.workspace,attachedUsers:n.workspace.users.map(u=>u.id)},null,8,["workspace","attachedUsers"])]),default:e(()=>[n.workspace.users.length?(f(),x(de,{key:0},{head:e(()=>[t(R,null,{default:e(()=>[t(d,{component:"th",scope:"col"}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("general.name")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("general.email")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("team.role")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("team.can_approve")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("team.attached_at")),1)]),_:1}),t(d,{component:"th",scope:"col"})]),_:1})]),body:e(()=>[(f(!0),V(S,null,X(a(B.sortBy)(n.workspace.users,"pivot.joined_at"),u=>(f(),x(R,{key:n.workspace.id,hoverable:!0},{default:e(()=>[t(d,{align:"left"},{default:e(()=>[k("div",ve,[t(Y,{name:u.name},null,8,["name"])])]),_:2},1024),t(d,null,{default:e(()=>[r(o(u.name),1)]),_:2},1024),t(d,null,{default:e(()=>[r(o(u.email),1)]),_:2},1024),t(d,null,{default:e(()=>[t(j,null,{default:e(()=>[k("span",ge,o(a(s)(`team.${u.pivot.role}`)),1)]),_:2},1024)]),_:2},1024),t(d,null,{default:e(()=>[u.pivot.can_approve?(f(),x(j,{key:1,variant:"info"},{default:e(()=>[r(o(a(s)("general.yes")),1)]),_:1})):(f(),x(j,{key:0},{default:e(()=>[r(o(a(s)("general.no")),1)]),_:1}))]),_:2},1024),t(d,null,{default:e(()=>[r(o(u.pivot.joined_at),1)]),_:2},1024),t(d,{align:"right"},{default:e(()=>[k("div",$e,[ee((f(),x(pe,{href:i.route(`${a(w)}.users.view`,{user:u.id}),class:"mr-xs"},{default:e(()=>[t(me)]),_:2},1032,["href"])),[[G,a(s)("general.view")]]),t(te,{placement:"bottom-end"},{trigger:e(()=>[t(ue)]),content:e(()=>[t(T,{onClick:H=>p(u),as:"button"},{icon:e(()=>[t(q)]),default:e(()=>[r(" "+o(a(s)("team.edit_role")),1)]),_:2},1032,["onClick"]),t(T,{onClick:H=>v(u),as:"button"},{icon:e(()=>[t(I,{class:"text-red-500"})]),default:e(()=>[r(" "+o(a(s)("general.detach")),1)]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(f(),x(ie,{key:1}))]),_:1}),t(E,{show:h.value!==null,"max-width":"md","scrollable-body":!0,closeable:!0,onClose:_},{header:e(()=>[k("span",null,[r(o(a(s)("team.edit_role_for"))+" ",1),k("span",ye,o(h.value.name),1)])]),body:e(()=>[t(W,{modelValue:a(l).role,"onUpdate:modelValue":$[0]||($[0]=u=>a(l).role=u),class:"mt-xs"},null,8,["modelValue"]),t(Z,{class:"mt-lg"},{default:e(()=>[t(M,{modelValue:a(l).can_approve,"onUpdate:modelValue":$[1]||($[1]=u=>a(l).can_approve=u)},null,8,["modelValue"])]),_:1})]),footer:e(()=>[t(U,{onClick:_,class:"mr-xs"},{default:e(()=>[r(o(a(s)("general.cancel")),1)]),_:1}),t(A,{onClick:g,disabled:a(l).processing,isLoading:a(l).processing},{default:e(()=>[r(o(a(s)("general.update")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])],64)}}},be={class:"w-full mx-auto row-py"},Ve={class:"flex items-center"},Ce={class:"row-px"},Ue={class:"mt-lg"},Se=se({layout:ne}),Ke=Object.assign(Se,{__name:"View",props:{workspace:{type:Object}},setup(n){const{t:s}=P(),w=b("routePrefix"),y=b("confirmation"),m=n,{notify:c}=L(),h=()=>{y().title(s("workspace.delete_workspace")).description(s("workspace.confirm_delete_workspace")).destructive().onConfirm(l=>{l.isLoading(!0),F.delete(route(`${w}.workspaces.delete`,{workspace:m.workspace.uuid}),{onSuccess(){c("success",s("workspace.workspace_deleted"))}})}).show()};return(l,p)=>(f(),V(S,null,[t(a(oe),{title:a(s)("workspace.view_workspace")},null,8,["title"]),k("div",be,[t(ce,{title:a(s)("workspace.view_workspace")},{description:e(()=>[r(o(n.workspace.name),1)]),default:e(()=>[k("div",Ve,[t(a(z),{href:l.route("mixpost.switchWorkspace",{workspace:n.workspace.uuid,redirect:!0}),method:"post",as:"button",type:"button",class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[t(U,{size:"sm"},{icon:e(()=>[t(fe)]),default:e(()=>[r(" "+o(a(s)("general.open")),1)]),_:1})]),_:1},8,["href"]),t(a(z),{href:l.route(`${a(w)}.workspaces.edit`,{workspace:n.workspace.uuid}),class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[t(A,{size:"sm"},{icon:e(()=>[t(q)]),default:e(()=>[r(" "+o(a(s)("general.edit")),1)]),_:1})]),_:1},8,["href"]),t(le,{onClick:h,size:"sm"},{icon:e(()=>[t(I)]),_:1})])]),_:1},8,["title"]),k("div",Ce,[t(O,null,{title:e(()=>[r(o(a(s)("general.details")),1)]),default:e(()=>[t(N,null,{title:e(()=>[r(o(a(s)("general.name")),1)]),default:e(()=>[k("div",null,o(n.workspace.name),1)]),_:1}),t(N,{class:"mt-lg"},{title:e(()=>[r(o(a(s)("general.color")),1)]),default:e(()=>[k("div",{style:re({background:n.workspace.hex_color}),class:"w-xl h-xl rounded-md"},null,4)]),_:1})]),_:1}),k("div",Ue,[t(xe,{workspace:n.workspace},null,8,["workspace"])]),l.$page.props.mixpost.features.api_access_tokens?(f(),x(O,{key:0,class:"mt-lg"},{title:e(()=>[r(o(a(s)("system.usage_api")),1)]),default:e(()=>[t(_e,null,{default:e(()=>[r(o(n.workspace.uuid),1)]),_:1})]),_:1})):ae("",!0)])])],64))}});export{Ke as default};
