import{u as I,o as i,c as p,F as b,r as P,g as x,y as M,a as t,w as e,f as n,t as o,b as s,e as r,j as y,_ as k,k as V,ar as ue,n as F,a6 as de,T as G,N as O,m as le,i as X,s as ae,O as ce,C as h,G as fe,a7 as re,a3 as se,x as ne,z as K,a1 as me,d as _e,Z as pe}from"./app-BxavtTYs.js";import{_ as ve}from"./Minimal-3cE7t4f_.js";import{_ as T}from"./Radio-BACqEdPU.js";import{_ as oe}from"./Select-B7cBiASc.js";import{_ as D}from"./Flex-0eM5h-qJ.js";import{_ as Q}from"./InputHidden-tNUxRG45.js";import{_ as ge}from"./Panel-Lw-nuda0.js";import{_ as E}from"./SectionBorder-DHjf1gSK.js";import{_ as we}from"./PageHeader-BnI1hV_t.js";import{u as $e}from"./useRouter-7gUHwari.js";import{_ as he}from"./BackToDashboardButton-CSfjzOnm.js";import"./Eye-hTbiOyAR.js";import"./ArrowLeft-D9geFYok.js";const ye=["value"],be={key:0,class:"text-xs text-gray-500 mt-xs block"},ke={class:"font-medium"},xe=["label"],Ce=["value"],Ve={class:"flex items-center space-x-xs rtl:space-x-reverse"},Le={class:"flex items-center space-x-xs rtl:space-x-reverse"},Pe={__name:"Preferences",props:{form:{type:Object,require:!0},locales:{type:Array,required:!0},timezone_list:{type:Object,required:!0}},setup(u){const l=I(),{t:c}=l,a=u,v=$=>a.locales.find(m=>m.long===$).direction||"ltr",g=$=>!["en-GB","fr-CA","ar-SA","de-DE","es-MX"].includes($),{notify:f}=F(),d=()=>{a.form.put(route("mixpost.profile.updatePreferences"),{preserveScroll:!0,onSuccess(){ue.changeLocale(l,a.form.locale,v(a.form.locale)),f("success",c("profile.preferences_updated"))}})};return($,m)=>(i(),p("div",null,[(i(!0),p(b,null,P(u.form.errors,_=>(i(),x(M,{message:_,class:"mb-xs"},null,8,["message"]))),256)),t(k,null,{title:e(()=>[n(o(s(c)("general.language")),1)]),default:e(()=>[r("div",null,[t(oe,{modelValue:u.form.locale,"onUpdate:modelValue":m[0]||(m[0]=_=>u.form.locale=_)},{default:e(()=>[(i(!0),p(b,null,P(u.locales,_=>(i(),p("option",{value:_.long},o(_.english)+" - "+o(_.native)+" - ("+o(_.long)+") "+o(g(_.long)?"[Beta]":""),9,ye))),256))]),_:1},8,["modelValue"]),g(u.form.locale)?(i(),p("span",be,[m[6]||(m[6]=n(" ðŸš§ Language ")),r("span",ke,o(u.form.locale),1),m[7]||(m[7]=n(" is in beta and may not be fully translated or can contain errors. "))])):y("",!0)])]),_:1}),t(k,{class:"mt-lg"},{title:e(()=>[n(o(s(c)("general.timezone")),1)]),default:e(()=>[r("div",null,[t(oe,{modelValue:u.form.timezone,"onUpdate:modelValue":m[1]||(m[1]=_=>u.form.timezone=_)},{default:e(()=>[(i(!0),p(b,null,P(u.timezone_list,(_,L)=>(i(),p("optgroup",{label:L},[(i(!0),p(b,null,P(_,(S,U)=>(i(),p("option",{value:U},o(S),9,Ce))),256))],8,xe))),256))]),_:1},8,["modelValue"])])]),_:1}),t(k,{class:"mt-lg"},{title:e(()=>[n(o(s(c)("profile.time_format")),1)]),default:e(()=>[r("div",Ve,[r("label",null,[t(T,{checked:u.form.time_format,"onUpdate:checked":m[2]||(m[2]=_=>u.form.time_format=_),value:12},null,8,["checked"]),n(" 12 "+o(s(c)("profile.hour")),1)]),r("label",null,[t(T,{checked:u.form.time_format,"onUpdate:checked":m[3]||(m[3]=_=>u.form.time_format=_),value:24},null,8,["checked"]),n(" 24 "+o(s(c)("profile.hour")),1)])])]),_:1}),t(k,{class:"mt-lg"},{title:e(()=>[n(o(s(c)("profile.first_day_week")),1)]),default:e(()=>[r("div",Le,[r("label",null,[t(T,{checked:u.form.week_starts_on,"onUpdate:checked":m[4]||(m[4]=_=>u.form.week_starts_on=_),value:0},null,8,["checked"]),n(" "+o(s(c)("profile.sunday")),1)]),r("label",null,[t(T,{checked:u.form.week_starts_on,"onUpdate:checked":m[5]||(m[5]=_=>u.form.week_starts_on=_),value:1},null,8,["checked"]),n(" "+o(s(c)("profile.monday")),1)])])]),_:1}),t(V,{onClick:d,class:"mt-lg"},{default:e(()=>[n(o(s(c)("general.save")),1)]),_:1})]))}},Se={for:"name"},Ue={for:"email"},ze={__name:"UserAccount",setup(u){const{t:l}=I(),{user:c}=de(),{notify:a}=F(),v=G({name:c.value.name,email:c.value.email}),g=()=>{v.put(route("mixpost.profile.updateUser"),{preserveScroll:!0,onSuccess(){a("success",l("account.account_updated"))}})};return(f,d)=>(i(),p("form",{onSubmit:le(g,["prevent"])},[(i(!0),p(b,null,P(s(v).errors,$=>(i(),x(M,{message:$,class:"mb-xs"},null,8,["message"]))),256)),t(k,null,{title:e(()=>[r("label",Se,o(s(l)("general.name")),1)]),default:e(()=>[t(O,{type:"text",modelValue:s(v).name,"onUpdate:modelValue":d[0]||(d[0]=$=>s(v).name=$),error:s(v).errors.name,id:"name"},null,8,["modelValue","error"])]),_:1}),t(k,{class:"mt-lg"},{title:e(()=>[r("label",Ue,o(s(l)("general.email")),1)]),default:e(()=>[t(O,{type:"email",modelValue:s(v).email,"onUpdate:modelValue":d[1]||(d[1]=$=>s(v).email=$),error:s(v).errors.email,id:"email"},null,8,["modelValue","error"])]),_:1}),t(V,{type:"submit",class:"mt-lg"},{default:e(()=>[n(o(s(l)("general.save")),1)]),_:1})],32))}},Ae={for:"password"},Ie={__name:"ConfirmPassword",props:{show:{type:Boolean,default:!0}},emits:["close","confirm"],setup(u,{emit:l}){const c=X("routePrefix"),a=l,v=()=>{a("close")},g=G({password:""}),f=()=>{g.post(route(`${c}.profile.confirmPassword`),{preserveScroll:!0,onSuccess(){a("confirm"),g.reset(),v()}})};return(d,$)=>(i(),x(ce,{show:u.show,"max-width":"lg",closeable:!0,"scrollable-body":!0,zIndexClass:"z-30",onClose:v},{header:e(()=>[n(o(d.$t("auth.confirm_password")),1)]),body:e(()=>[u.show?(i(),p(b,{key:0},[r("div",null,o(d.$t("profile.security_confirm_password")),1),t(k,{class:"mt-lg"},{title:e(()=>[r("label",Ae,o(d.$t("auth.password")),1)]),footer:e(()=>[t(M,{message:s(g).errors.password},null,8,["message"])]),default:e(()=>[t(O,{modelValue:s(g).password,"onUpdate:modelValue":$[0]||($[0]=m=>s(g).password=m),error:s(g).errors.password,type:"password",id:"password",class:"w-full",autocomplete:"password"},null,8,["modelValue","error"])]),_:1})],64)):y("",!0)]),footer:e(()=>[t(ae,{onClick:v,class:"mr-xs"},{default:e(()=>[n(o(d.$t("general.cancel")),1)]),_:1}),t(V,{onClick:f,disabled:s(g).processing,isLoading:s(g).processing,class:"mr-xs"},{default:e(()=>[n(o(d.$t("general.confirm")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"]))}},je={class:"mt-lg"},Be={key:0,class:"mt-lg"},Re=["innerHTML"],qe={class:"uppercase font-medium text-center"},Ne={class:"text-gray-500"},Te={class:"mt-md"},De={for:"code"},Ee={key:1},Oe={key:0,class:"mt-lg"},Me={class:"mt-xs bg-primary-50 rounded-lg p-md"},Fe={class:"mb-xs"},Ge={class:"font-medium"},He={__name:"TwoFactorAuth",setup(u){const{t:l}=I(),c=h({svg:"",secret_key:""}),a=h(!1),v=h(!1),g=h(""),f=h(!1),d=h(!1),$=h([]),m=h(!1),_=h(null),L=X("routePrefix"),{notify:S}=F(),U=fe(()=>v.value?!1:re().props.user_has_two_factor_auth_enabled||a.value===!0),ie=()=>{m.value=!0},Z=()=>{m.value=!1},j=h(!1),J=()=>{j.value=!0,axios.post(route(`${L}.profile.two-factor-auth.enable`)).then(w=>{f.value=!0,c.value=w.data}).catch(w=>z(w,J)).finally(()=>j.value=!1)},B=h(!1),W=()=>{B.value=!0,axios.post(route(`${L}.profile.two-factor-auth.confirm`),{code:g.value}).then(w=>{a.value=!0,v.value=!1,f.value=!1,$.value=w.data.recovery_codes,d.value=!0,g.value="",S("success",l("profile.two_factor_enabled"))}).catch(w=>z(w,W)).finally(()=>B.value=!1)},R=h(!1),Y=()=>{R.value=!0,axios.get(route(`${L}.profile.two-factor-auth.showRecoveryCodes`)).then(w=>{$.value=w.data.recovery_codes,d.value=!0}).catch(w=>z(w,Y)).finally(()=>R.value=!1)},q=h(!1),ee=()=>{q.value=!0,axios.post(route(`${L}.profile.two-factor-auth.regenerateRecoveryCodes`)).then(w=>{$.value=w.data.recovery_codes,d.value=!0}).catch(w=>z(w,ee)).finally(()=>q.value=!1)},N=h(!1),te=()=>{N.value=!0,axios.delete(route(`${L}.profile.two-factor-auth.disable`)).then(()=>{v.value=!0,S("success",l("profile.two_factor_disabled"))}).catch(w=>z(w,te)).finally(()=>N.value=!1)},z=(w,C)=>{if(w.response.status===422){w.response.data.errors.confirm_password&&(_.value=C,ie()),w.response.data.errors.code&&S("error",w.response.data.errors.code[0]);return}S("error",l("error.something_wrong"))};return(w,C)=>(i(),p(b,null,[r("div",null,[r("div",null,o(s(l)("profile.install_totp")),1),r("div",je,[U.value?(i(),x(se,{key:0,variant:"success"},{default:e(()=>[n(o(s(l)("general.enabled")),1)]),_:1})):y("",!0),U.value?y("",!0):(i(),x(se,{key:1,variant:"error"},{default:e(()=>[n(o(s(l)("general.disabled")),1)]),_:1}))]),f.value?(i(),p("div",Be,[t(D,{class:"w-full relative rounded-lg border border-gray-200 p-xs"},{default:e(()=>[r("div",{innerHTML:c.value.svg},null,8,Re),t(D,{class:"justify-center items-center w-full"},{default:e(()=>[r("div",qe,[r("div",Ne,o(s(l)("profile.secret_key")),1),r("div",null,o(c.value.secret_key),1)])]),_:1})]),_:1}),r("div",Te,o(s(l)("profile.scan_qr_code")),1),t(k,{class:"mt-lg"},{title:e(()=>[r("label",De,o(s(l)("profile.code")),1)]),default:e(()=>[t(O,{modelValue:g.value,"onUpdate:modelValue":C[0]||(C[0]=H=>g.value=H),type:"text",id:"code",class:"w-full",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(D,null,{default:e(()=>[t(V,{onClick:W,disabled:B.value,isLoading:B.value,class:"mt-lg"},{default:e(()=>[n(o(s(l)("general.confirm")),1)]),_:1},8,["disabled","isLoading"]),t(ae,{onClick:C[1]||(C[1]=()=>{f.value=!1,g.value=""}),class:"mt-lg"},{default:e(()=>[n(o(s(l)("general.cancel")),1)]),_:1})]),_:1})])):y("",!0),U.value?(i(),p("div",Ee,[d.value?(i(),p("div",Oe,[r("div",null,o(s(l)("profile.store_recovery_codes")),1),r("div",Me,[(i(!0),p(b,null,P($.value,H=>(i(),p("div",Fe,[r("div",Ge,o(H),1)]))),256))])])):y("",!0),t(D,{class:"mt-lg"},{default:e(()=>[d.value?(i(),x(V,{key:0,onClick:ee,disabled:q.value,isLoading:q.value},{default:e(()=>[n(o(s(l)("profile.regenerate_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])):y("",!0),d.value?y("",!0):(i(),x(V,{key:1,onClick:Y,disabled:R.value,isLoading:R.value},{default:e(()=>[n(o(s(l)("profile.show_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])),t(ne,{onClick:te,disabled:N.value,isLoading:N.value},{default:e(()=>[n(o(s(l)("general.disable")),1)]),_:1},8,["disabled","isLoading"])]),_:1})])):y("",!0),!U.value&&!f.value?(i(),x(V,{key:2,onClick:J,disabled:j.value,isLoading:j.value,class:"mt-lg"},{default:e(()=>[n(o(s(l)("general.enable")),1)]),_:1},8,["disabled","isLoading"])):y("",!0)]),t(Ie,{show:m.value,onConfirm:C[2]||(C[2]=()=>{Z(),_.value&&_.value()}),onClose:Z},null,8,["show"])],64))}},Ke={for:"current_password"},Qe={for:"password"},Xe={for:"password_confirmation"},Ze={__name:"Password",setup(u){const{t:l}=I(),{notify:c}=F(),a=G({current_password:"",password:"",password_confirmation:""}),v=()=>{a.put(route("mixpost.profile.updatePassword"),{preserveScroll:!0,onSuccess(){a.reset(),c("success",l("profile.password_changed"))}})};return(g,f)=>(i(),p("form",{onSubmit:le(v,["prevent"])},[(i(!0),p(b,null,P(s(a).errors,d=>(i(),x(M,{message:d,class:"mb-xs"},null,8,["message"]))),256)),t(k,{class:"mt-lg"},{title:e(()=>[r("label",Ke,o(s(l)("profile.current_password")),1)]),default:e(()=>[t(Q,{modelValue:s(a).current_password,"onUpdate:modelValue":f[0]||(f[0]=d=>s(a).current_password=d),error:s(a).errors.current_password,id:"current_password",required:""},null,8,["modelValue","error"])]),_:1}),t(k,{class:"mt-md"},{title:e(()=>[r("label",Qe,o(s(l)("profile.new_password")),1)]),default:e(()=>[t(Q,{modelValue:s(a).password,"onUpdate:modelValue":f[1]||(f[1]=d=>s(a).password=d),error:s(a).errors.password,id:"password",autocomplete:"new-password",required:""},null,8,["modelValue","error"])]),_:1}),t(k,{class:"mt-md"},{title:e(()=>[r("label",Xe,o(s(l)("profile.confirm_new_password")),1)]),default:e(()=>[t(Q,{modelValue:s(a).password_confirmation,"onUpdate:modelValue":f[2]||(f[2]=d=>s(a).password_confirmation=d),error:s(a).password_confirmationpassword,id:"password_confirmation",autocomplete:"new-password",required:""},null,8,["modelValue","error"])]),_:1}),t(V,{type:"submit",class:"mt-lg"},{default:e(()=>[n(o(s(l)("general.save")),1)]),_:1})],32))}},Je={class:"md:grid md:grid-cols-3 md:gap-lg"},We={class:"md:col-span-1 flex justify-between"},Ye={class:"text-lg font-medium text-gray-900"},et={class:"mt-xs text-gray-500"},tt={class:"mt-lg md:mt-0 md:col-span-2"},A={__name:"ActionSection",setup(u){return(l,c)=>(i(),p("div",Je,[r("div",We,[r("div",null,[r("h3",Ye,[K(l.$slots,"title")]),r("p",et,[K(l.$slots,"description")])])]),r("div",tt,[t(ge,null,{default:e(()=>[K(l.$slots,"default")]),_:3})])]))}},st={__name:"DeleteAccount",setup(u){const{t:l}=I(),c=X("confirmation"),{onError:a}=$e(),v=()=>{c().title(l("profile.delete_account")).description(l("profile.delete_account_desc")).destructive().btnConfirmName(l("profile.delete_account")).onConfirm(f=>{f.isLoading(!0),g(f)}).show()},g=f=>{me.delete(re().props.delete_account_url,{onSuccess(){f.reset()},onError(d){f.isLoading(!1),a(d,()=>{f.isLoading(!0),g(f)})}})};return(f,d)=>(i(),x(ne,{onClick:v},{default:e(()=>[n(o(s(l)("profile.delete_account")),1)]),_:1}))}},ot={class:"row-py w-full mx-auto !pt-0"},lt={class:"w-full mb-lg"},at={class:"mt-2xl sm:mt-0"},rt={class:"mt-2xl sm:mt-0"},nt={class:"mt-2xl sm:mt-0"},it={class:"mt-2xl sm:mt-0"},ut={class:"mt-2xl sm:mt-0"},dt=_e({layout:ve}),xt=Object.assign(dt,{__name:"Profile",props:["settings","locales","timezone_list","user_has_two_factor_auth_enabled","is_delete_account_enabled"],setup(u){const c=G(u.settings);return(a,v)=>(i(),p(b,null,[t(s(pe),{title:a.$t("profile.edit_profile")},null,8,["title"]),t(we,{title:a.$t("profile.edit_profile"),class:"!px-0"},{default:e(()=>[t(he)]),_:1},8,["title"]),r("div",ot,[r("div",lt,[r("div",at,[t(A,null,{title:e(()=>[n(o(a.$t("profile.profile_information")),1)]),description:e(()=>[n(o(a.$t("profile.update_your_account")),1)]),default:e(()=>[t(ze)]),_:1})]),t(E,{contrasted:!0}),r("div",rt,[t(A,null,{title:e(()=>[n(o(a.$t("profile.preferences")),1)]),description:e(()=>[n(o(a.$t("profile.update_preferences")),1)]),default:e(()=>[t(Pe,{form:s(c),timezone_list:u.timezone_list,locales:u.locales},null,8,["form","timezone_list","locales"])]),_:1})]),a.$page.props.is_two_factor_auth_enabled?(i(),p(b,{key:0},[t(E,{contrasted:!0}),r("div",nt,[t(A,null,{title:e(()=>[n(o(a.$t("auth.two_factor_authentication")),1)]),description:e(()=>[n(o(a.$t("auth.security_using_two_factor")),1)]),default:e(()=>[t(He)]),_:1})])],64)):y("",!0),t(E,{contrasted:!0}),r("div",it,[t(A,null,{title:e(()=>[n(o(a.$t("auth.update_password")),1)]),description:e(()=>[n(o(a.$t("auth.confirm_secure_password")),1)]),default:e(()=>[t(Ze)]),_:1})]),u.is_delete_account_enabled?(i(),p(b,{key:1},[t(E,{contrasted:!0}),r("div",ut,[t(A,null,{title:e(()=>[n(o(a.$t("profile.delete_account")),1)]),description:e(()=>[n(o(a.$t("profile.delete_account_desc")),1)]),default:e(()=>[t(st)]),_:1})])],64)):y("",!0)])])],64))}});export{xt as default};
