import{u as B,i as S,q as M,o as f,g as w,w as e,a as t,z as W,f as r,t as s,b as o,v as q,a1 as V,a5 as E,C as O,as as X,c as T,k as R,e as $,y as P,N as A,j as D,s as Y,O as F,F as L,L as ee,S as te,d as oe,Z as se,a8 as U,r as ae}from"./app-BxavtTYs.js";import{u as ne}from"./useSelectable-BJ_lcm9V.js";import{_ as re}from"./Minimal-3cE7t4f_.js";import{_ as le}from"./PageHeader-BnI1hV_t.js";import{_ as z}from"./Flex-0eM5h-qJ.js";import{T as H}from"./Trash-B9tkDRbU.js";import{_ as Z}from"./PureDangerButton-zhKtSmpI.js";import{_ as ie}from"./SelectableBar-CA2MAe5u.js";import{_ as ce}from"./Panel-Lw-nuda0.js";import{_,a as G,T as de}from"./TableCell-C46VQBCN.js";import{_ as j}from"./Checkbox-CKdbYkOi.js";import{_ as ue}from"./NoResult-DNS5zprA.js";import{u as J}from"./useRouter-7gUHwari.js";import{u as me}from"./useAPIForm-C4g3lxb7.js";import{_ as I}from"./VerticalGroup-DHZRXNYR.js";import{_ as N}from"./LabelSuffix-CL1UEugD.js";import{_ as _e}from"./Alert-BlT5orGN.js";import{_ as fe}from"./Select-B7cBiASc.js";import{_ as pe}from"./ClipboardCard-COMTvcXc.js";import{_ as ke}from"./SuccessButton-DIpt_Jo-.js";import{_ as $e}from"./Pagination-CB2UcsG3.js";import{_ as ve}from"./BackToDashboardButton-CSfjzOnm.js";import"./ClipboardButton-zAZn9sLi.js";import"./Clipboard-D9JxKoAX.js";import"./ChevronLeft-C0HP3zNo.js";import"./ArrowLeft-D9geFYok.js";const ge={__name:"TokenItem",props:{item:{type:Object,required:!0}},setup(c){const{t:l}=B(),h=S("routePrefix"),C=S("confirmation"),v=c,{onError:d}=J(),a=()=>{C().title(l("access_token.delete")).description(l("access_token.delete_confirm")).destructive().onConfirm(u=>{g(u)}).show()},g=u=>{u.isLoading(!0),V.delete(route(`${h}.profile.accessTokens.delete`,{token:v.item.id}),{onSuccess(){u.reset(),E.emit("tokenDelete",v.item.id)},onError(y){d(y,()=>{g(u)})},onFinish(){u.isLoading(!1)}})};return(u,y)=>{const b=M("tooltip");return f(),w(G,{hoverable:!0},{default:e(()=>[t(_,{class:"w-10"},{default:e(()=>[W(u.$slots,"checkbox")]),_:3}),t(_,null,{default:e(()=>[r(s(c.item.name),1)]),_:1}),t(_,null,{default:e(()=>[r(s(c.item.last_used_at?c.item.last_used_at:o(l)("access_token.never_used")),1)]),_:1}),t(_,null,{default:e(()=>[r(s(c.item.expires_at),1)]),_:1}),t(_,null,{default:e(()=>[r(s(c.item.created_at),1)]),_:1}),t(_,null,{default:e(()=>[q((f(),w(Z,{onClick:a},{default:e(()=>[t(H,{class:"!w-5 !h-5"})]),_:1})),[[b,o(l)("general.delete")]])]),_:1})]),_:3})}}},he={for:"token_name"},ye={for:"expiration"},be={value:"days-7"},xe={value:"days-30"},Ce={value:"days-60"},we={value:"days-90"},Te={value:"never-expires"},Se={value:"custom"},Ve={__name:"CreateUserToken",emits:["added"],setup(c,{emit:l}){const h=S("routePrefix"),C=l,v=O(!1),d=O(""),a=me({name:"",expiration:"days-7",expires_at:""}),g=()=>{v.value=!0},u=()=>{v.value=!1,a.reset(),a.clearErrors()},{onCatch:y}=X(),b=()=>{a.post(route(`${h}.profile.accessTokens.store`),{onSuccess(n){u(),a.reset(),d.value=n.plain_text_token,C("added")},onError(n){y(n,b)}})};return(n,i)=>(f(),T(L,null,[t(R,{onClick:g},{default:e(()=>[r(s(n.$t("access_token.create")),1)]),_:1}),t(F,{show:v.value,"max-width":"md",closeable:!0,"scrollable-body":!0,onClose:u},{header:e(()=>[r(s(n.$t("access_token.create")),1)]),body:e(()=>[t(I,null,{title:e(()=>[$("label",he,[r(s(n.$t("general.name"))+" ",1),t(N,{danger:!0},{default:e(()=>i[5]||(i[5]=[r("*")])),_:1})])]),footer:e(()=>[t(P,{message:o(a).errors.name},null,8,["message"])]),default:e(()=>[t(A,{type:"text",modelValue:o(a).name,"onUpdate:modelValue":i[0]||(i[0]=p=>o(a).name=p),error:o(a).errors.name!==void 0,id:"token_name",placeholder:n.$t("access_token.name_placeholder")},null,8,["modelValue","error","placeholder"])]),_:1}),t(I,{class:"mt-lg"},{title:e(()=>[$("label",ye,[r(s(n.$t("access_token.expiration"))+" ",1),t(N,{danger:!0},{default:e(()=>i[6]||(i[6]=[r("*")])),_:1})])]),footer:e(()=>[t(P,{message:o(a).errors.expiration},null,8,["message"]),t(P,{message:o(a).errors.expires_at},null,8,["message"])]),default:e(()=>[t(z,{class:"w-full"},{default:e(()=>[t(fe,{modelValue:o(a).expiration,"onUpdate:modelValue":i[1]||(i[1]=p=>o(a).expiration=p),error:o(a).errors.expiration!==void 0,id:"expiration"},{default:e(()=>[$("option",be,s(n.$t("calendar.days",{count:7})),1),$("option",xe,s(n.$t("calendar.days",{count:30})),1),$("option",Ce,s(n.$t("calendar.days",{count:60})),1),$("option",we,s(n.$t("calendar.days",{count:90})),1),$("option",Te,s(n.$t("access_token.never_expires")),1),$("option",Se,s(n.$t("general.custom")),1)]),_:1},8,["modelValue","error"]),o(a).expiration==="custom"?(f(),w(A,{key:0,type:"date",modelValue:o(a).expires_at,"onUpdate:modelValue":i[2]||(i[2]=p=>o(a).expires_at=p),error:o(a).errors.expires_at,id:"expiration"},null,8,["modelValue","error"])):D("",!0)]),_:1})]),_:1})]),footer:e(()=>[t(Y,{onClick:u,class:"mr-xs"},{default:e(()=>[r(s(n.$t("general.cancel")),1)]),_:1}),t(R,{onClick:b,disabled:o(a).processing,isLoading:o(a).processing},{default:e(()=>[r(s(n.$t("general.create")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"]),t(F,{show:d.value!=="","max-width":"xl",closeable:!0,"scrollable-body":!0,onClose:i[4]||(i[4]=p=>d.value="")},{header:e(()=>[r(s(n.$t("access_token.create")),1)]),body:e(()=>[d.value?(f(),T(L,{key:0},[t(_e,{variant:"warning",closeable:!1},{default:e(()=>[r(s(n.$t("access_token.copy_token")),1)]),_:1}),t(pe,{class:"mt-lg"},{default:e(()=>[r(s(d.value),1)]),_:1})],64)):D("",!0)]),footer:e(()=>[t(ke,{onClick:i[3]||(i[3]=p=>d.value="")},{default:e(()=>[r(s(n.$t("system.stored_safely")),1)]),_:1})]),_:1},8,["show"])],64))}},De={class:"row-py w-full mx-auto !pt-0"},Le={key:0,class:"mt-lg"},Pe=oe({layout:re}),at=Object.assign(Pe,{__name:"AccessTokens",props:["tokens"],setup(c){const{t:l}=B(),h=c,C=S("routePrefix"),v=S("confirmation"),{selectedRecords:d,putPageRecords:a,toggleSelectRecordsOnPage:g,deselectRecord:u,deselectAllRecords:y}=ne(),b=()=>h.tokens.data.map(m=>m.id);ee(()=>{a(b()),E.on("tokenDelete",m=>{u(m)})}),te(()=>h.tokens.data,()=>{a(b())});const{onError:n}=J(),i=()=>{v().title(l("access_token.delete_items")).description(l("access_token.delete_items_confirm")).destructive().onConfirm(m=>{m.isLoading(!0),V.delete(route(`${C}.profile.accessTokens.deleteMultiple`),{data:{tokens:d.value},preserveScroll:!0,onSuccess(){m.reset(),y()},onError(k){n(k,()=>{p(m)})},onFinish(){m.isLoading(!1)}})}).show()},p=m=>{m.isLoading(!0),V.delete(route(`${C}.profile.accessTokens.deleteMultiple`),{data:{tokens:d.value},preserveScroll:!0,onSuccess(){m.reset(),E.emit("tokenDelete",h.item.id)},onError(k){n(k,()=>{p(m)})},onFinish(){m.isLoading(!1)}})};return(m,k)=>{const K=M("tooltip");return f(),T(L,null,[t(o(se),{title:o(l)("access_token.access_tokens")},null,8,["title"]),t(le,{title:o(l)("access_token.access_tokens"),class:"!px-0"},{description:e(()=>[r(s(o(l)("access_token.desc")),1)]),default:e(()=>[t(ve)]),_:1},8,["title"]),$("div",De,[t(ie,{count:o(d).length,onClose:o(y)},{default:e(()=>[q((f(),w(Z,{onClick:i},{default:e(()=>[t(H)]),_:1})),[[K,o(l)("general.delete")]])]),_:1},8,["count","onClose"]),t(z,null,{default:e(()=>[t(Ve,{onAdded:k[0]||(k[0]=x=>o(V).get(m.route("mixpost.profile.accessTokens.index"),{},{only:["tokens"],preserveState:!0,preserveScroll:!0}))})]),_:1}),t(ce,{"with-padding":!1,class:"mt-lg"},{default:e(()=>[t(de,null,{head:e(()=>[t(G,null,{default:e(()=>[t(_,{component:"th",scope:"col",class:"w-10"},{default:e(()=>[t(j,{checked:o(g),"onUpdate:checked":k[1]||(k[1]=x=>U(g)?g.value=x:null),disabled:!c.tokens.data.length},null,8,["checked","disabled"])]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("general.name")),1)]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("access_token.last_usage")),1)]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("access_token.expires_at")),1)]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("general.created_at")),1)]),_:1}),t(_,{component:"th",scope:"col"})]),_:1})]),body:e(()=>[(f(!0),T(L,null,ae(c.tokens.data,x=>(f(),w(ge,{key:x.id,item:x,onOnDelete:()=>{o(u)(x.id)}},{checkbox:e(()=>[t(j,{checked:o(d),"onUpdate:checked":k[2]||(k[2]=Q=>U(d)?d.value=Q:null),value:x.id},null,8,["checked","value"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),c.tokens.data.length?D("",!0):(f(),w(ue,{key:0,class:"p-md"},{default:e(()=>[r(s(o(l)("access_token.no_result")),1)]),_:1}))]),_:1}),c.tokens.meta.links.length>3?(f(),T("div",Le,[t($e,{meta:c.tokens.meta,links:c.tokens.links},null,8,["meta","links"])])):D("",!0)])],64)}}});export{at as default};
