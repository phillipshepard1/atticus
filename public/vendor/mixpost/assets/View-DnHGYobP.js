import{i as b,C as x,l as I,a4 as q,o as v,c as w,a,w as e,f as l,t,T,P as M,s as j,b as o,k as P,O as A,F as S,q as Z,g as y,r as G,e as $,ab as H,a3 as V,v as J,V as K,U as L,a0 as N,a1 as O,u as Q,a6 as X,d as Y,Z as ee,h as ae,x as se,j as te,_ as C,n as le}from"./app-BxavtTYs.js";import{_ as oe}from"./Admin-CpLrPT1Z.js";import{_ as re}from"./PageHeader-BnI1hV_t.js";import{_ as B}from"./Panel-Lw-nuda0.js";import{T as R}from"./Trash-B9tkDRbU.js";import{_ as ne}from"./NoResult-DNS5zprA.js";import{_ as ue}from"./DropdownButton-DyMVBGMY.js";import{_ as z,a as E}from"./CanApprove-Ppwv2_eW.js";import{_ as F}from"./VerticalGroup-DHZRXNYR.js";import{a as W,_ as h,T as ie}from"./TableCell-C46VQBCN.js";import{E as ce}from"./Eye-hTbiOyAR.js";import{_ as de}from"./PureButtonLink-hEv16skr.js";import"./QueueList-CJbQdoC3.js";import"./Flex-0eM5h-qJ.js";import"./EllipsisVertical-DCDthPML.js";import"./Radio-BACqEdPU.js";import"./Checkbox-CKdbYkOi.js";const me={class:"relative w-full"},fe={__name:"SelectWorkspace",props:{modelValue:{default:null},workspaces:{type:Array,default:[]},exclude:{type:Array,default:[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{emit:n}){const p=r,c=b("routePrefix"),_=x(p.workspaces),u=(i,m)=>{i&&(m(!0),k(m,i))},k=I.throttle((i,m)=>{axios.get(route(`${c}.workspaces.resources.items`),{params:{keyword:m,exclude:p.exclude}}).then(d=>{i(!1),_.value=d.data.data.map(s=>({key:s.uuid,label:s.name}))})},350);return(i,m)=>{const d=q("v-select");return v(),w("div",me,[a(d,{modelValue:r.modelValue,"onUpdate:modelValue":m[0]||(m[0]=s=>i.$emit("update:modelValue",s)),options:_.value,filterable:!1,"close-on-select":!0,disabled:r.disabled,placeholder:i.$t("workspace.type_search_workspace"),onSearch:u},{"no-options":e(({search:s,searching:g,loading:U})=>[l(t(i.$t("general.list_empty")),1)]),_:1},8,["modelValue","options","disabled","placeholder"])])}}},pe={__name:"AttachWorkspace",props:{user:{type:Object},attachedWorkspaces:{type:Array,default:[]}},setup(r){b("routePrefix");const n=r,p=x(null),c=T({user_id:n.user.id,role:"admin",can_approve:!1}),_=()=>{c.post(route("mixpost.workspaces.users.store",{workspace:p.value.key}),{preserveScroll:!0,onSuccess(){i(),c.reset()}})},u=x(!1),k=()=>{u.value=!0},i=()=>{u.value=!1,p.value=null};return(m,d)=>(v(),w(S,null,[a(j,{onClick:k,size:"sm"},{icon:e(()=>[a(M)]),default:e(()=>[l(" "+t(m.$t("team.attach")),1)]),_:1}),a(A,{show:u.value,"max-width":"md","scrollable-body":!0,closeable:!0,onClose:i},{header:e(()=>[l(t(m.$t("team.attach_workspace")),1)]),body:e(()=>[a(fe,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=s=>p.value=s),exclude:r.attachedWorkspaces},null,8,["modelValue","exclude"]),a(z,{modelValue:o(c).role,"onUpdate:modelValue":d[1]||(d[1]=s=>o(c).role=s),class:"mt-lg"},null,8,["modelValue"]),a(F,{class:"mt-lg"},{default:e(()=>[a(E,{modelValue:o(c).can_approve,"onUpdate:modelValue":d[2]||(d[2]=s=>o(c).can_approve=s)},null,8,["modelValue"])]),_:1})]),footer:e(()=>[a(j,{onClick:i,class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[l(t(m.$t("general.cancel")),1)]),_:1}),a(P,{onClick:_,disabled:!p.value||o(c).processing,isLoading:o(c).processing},{default:e(()=>[l(t(m.$t("team.attach")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])],64))}},_e={class:"flex justify-start"},he={class:"capitalize"},ve={class:"flex justify-end"},$e={__name:"UserWorkspaces",props:{user:{type:Object}},setup(r){const n=b("routePrefix"),p=b("confirmation"),c=r,_=x(null),u=T({user_id:c.user.id,role:"admin",can_approve:!1}),k=s=>{u.role=s.pivot.role,u.can_approve=s.pivot.can_approve,_.value=s},i=()=>{_.value=null},m=s=>{p().title($t("team.detach_workspace")).description($t("team.detach_confirm",{workspace:s.name,user:c.user.name})).destructive().btnConfirmName($t("admin.detach")).onConfirm(g=>{g.isLoading(!0),O.delete(route(`${n}.workspaces.users.delete`,{workspace:s.uuid}),{data:{user_id:c.user.id},preserveScroll:!0,onSuccess(){g.reset()},onFinish(){g.isLoading(!1)}})}).show()},d=()=>{u.put(route(`${n}.workspaces.users.update`,{workspace:_.value.uuid}),{data:{user_id:c.user.id},preserveScroll:!0,onSuccess(){u.reset(),i()}})};return(s,g)=>{const U=Z("tooltip");return v(),w(S,null,[a(B,null,{title:e(()=>[l(t(s.$t("workspace.workspaces")),1)]),action:e(()=>[a(pe,{user:r.user,attachedWorkspaces:r.user.workspaces.map(f=>f.uuid)},null,8,["user","attachedWorkspaces"])]),default:e(()=>[r.user.workspaces.length?(v(),y(ie,{key:0},{head:e(()=>[a(W,null,{default:e(()=>[a(h,{component:"th",scope:"col"}),a(h,{component:"th",scope:"col"},{default:e(()=>[l(t(s.$t("general.name")),1)]),_:1}),a(h,{component:"th",scope:"col"},{default:e(()=>[l(t(s.$t("team.role")),1)]),_:1}),a(h,{component:"th",scope:"col"},{default:e(()=>[l(t(s.$t("team.can_approve")),1)]),_:1}),a(h,{component:"th",scope:"col"},{default:e(()=>[l(t(s.$t("team.attached_at")),1)]),_:1}),a(h,{component:"th",scope:"col"})]),_:1})]),body:e(()=>[(v(!0),w(S,null,G(r.user.workspaces,f=>(v(),y(W,{key:f.id,hoverable:!0},{default:e(()=>[a(h,{align:"left"},{default:e(()=>[$("div",_e,[a(H,{backgroundColor:f.hex_color,name:f.name,roundedClass:"rounded-lg"},null,8,["backgroundColor","name"])])]),_:2},1024),a(h,null,{default:e(()=>[$("div",null,t(f.name),1)]),_:2},1024),a(h,null,{default:e(()=>[a(V,null,{default:e(()=>[$("span",he,t(f.pivot.role),1)]),_:2},1024)]),_:2},1024),a(h,null,{default:e(()=>[f.pivot.can_approve?(v(),y(V,{key:1,variant:"info"},{default:e(()=>[l(t(s.$t("general.yes")),1)]),_:1})):(v(),y(V,{key:0},{default:e(()=>[l(t(s.$t("general.no")),1)]),_:1})),a(V)]),_:2},1024),a(h,null,{default:e(()=>[l(t(f.pivot.joined_at),1)]),_:2},1024),a(h,{align:"right"},{default:e(()=>[$("div",ve,[J((v(),y(de,{href:s.route(`${o(n)}.workspaces.view`,{workspace:f.uuid}),class:"mr-xs"},{default:e(()=>[a(ce)]),_:2},1032,["href"])),[[U,s.$t("general.view")]]),a(K,{placement:"bottom-end"},{trigger:e(()=>[a(ue)]),content:e(()=>[a(L,{onClick:D=>k(f),as:"button"},{default:e(()=>[a(N,{class:"mr-xs"}),l(" "+t(s.$t("team.edit_role")),1)]),_:2},1032,["onClick"]),a(L,{onClick:D=>m(f),as:"button"},{default:e(()=>[a(R,{class:"text-red-500 mr-xs"}),l(" "+t(s.$t("general.detach")),1)]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(v(),y(ne,{key:1}))]),_:1}),a(A,{show:_.value!==null,"max-width":"md","scrollable-body":!0,closeable:!0,onClose:i},{header:e(()=>[$("div",null,[l(t(s.$t("team.edit_role_on"))+" ",1),$("strong",null,t(_.value.name),1),l(" "+t(s.$t("workspace.workspaces")),1)])]),body:e(()=>[a(z,{modelValue:o(u).role,"onUpdate:modelValue":g[0]||(g[0]=f=>o(u).role=f),class:"mt-xs"},null,8,["modelValue"]),a(F,{class:"mt-lg"},{default:e(()=>[a(E,{modelValue:o(u).can_approve,"onUpdate:modelValue":g[1]||(g[1]=f=>o(u).can_approve=f)},null,8,["modelValue"])]),_:1})]),footer:e(()=>[a(j,{onClick:i,class:"mr-xs"},{default:e(()=>[l(t(s.$t("general.cancel")),1)]),_:1}),a(P,{onClick:d,disabled:o(u).processing,isLoading:o(u).processing},{default:e(()=>[l(t(s.$t("general.update")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])],64)}}},ge={class:"w-full mx-auto row-py"},ke={class:"flex items-center"},ye={class:"row-px"},be={class:"md:max-w-2xl"},we={class:"mt-lg"},Ve=Y({layout:oe}),De=Object.assign(Ve,{__name:"View",props:{user:{type:Object}},setup(r){const{t:n}=Q(),p=b("routePrefix"),c=b("confirmation"),_=r,u=n("user.view_user"),{notify:k}=le(),{user:i}=X(),m=()=>{c().title(n("user.delete_users")).description(n("user.confirm_delete_user")).destructive().onConfirm(d=>{d.isLoading(!0),O.delete(route(`${p}.users.delete`,{user:_.user.id}),{onSuccess(s){s.props.flash.error||k("success",n("user.user_deleted"))},onFinish(){d.isLoading(!1)}})}).show()};return(d,s)=>(v(),w(S,null,[a(o(ee),{title:o(u)},null,8,["title"]),$("div",ge,[a(re,{title:o(u)},{description:e(()=>[l(t(r.user.name),1)]),default:e(()=>[$("div",ke,[a(o(ae),{href:d.route(`${o(p)}.users.edit`,{user:r.user.id}),class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[a(P,{size:"sm"},{icon:e(()=>[a(N)]),default:e(()=>[l(" "+t(o(n)("general.edit")),1)]),_:1})]),_:1},8,["href"]),o(i).id!==r.user.id?(v(),y(se,{key:0,onClick:m,size:"sm"},{icon:e(()=>[a(R)]),_:1})):te("",!0)])]),_:1},8,["title"]),$("div",ye,[a(B,null,{title:e(()=>[l(t(o(n)("user.user_details")),1)]),default:e(()=>[$("div",be,[a(C,null,{title:e(()=>[l(t(o(n)("general.name")),1)]),default:e(()=>[l(" "+t(r.user.name),1)]),_:1}),a(C,{class:"mt-md"},{title:e(()=>[l(t(o(n)("general.email")),1)]),default:e(()=>[l(" "+t(r.user.email),1)]),_:1}),a(C,{class:"mt-md"},{title:e(()=>[l(t(o(n)("general.created_at")),1)]),default:e(()=>[l(" "+t(r.user.created_at),1)]),_:1}),a(C,{class:"mt-md"},{title:e(()=>[l(t(o(n)("user.system_admin")),1)]),default:e(()=>[l(" "+t(r.user.is_admin?o(n)("general.yes"):o(n)("general.no")),1)]),_:1})])]),_:1}),$("div",we,[a($e,{user:r.user},null,8,["user"])])])])],64))}});export{De as default};
