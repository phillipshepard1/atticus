import{u as U,i as k,C as A,L as M,a5 as R,R as W,S,l as _,a1 as O,q,c as w,a as e,b as o,e as P,w as t,j as B,F as T,o as n,Z as z,f as m,t as u,k as Z,P as G,h as H,v as J,g as b,a8 as j,r as K}from"./app-BxavtTYs.js";import{u as Q}from"./useRouter-7gUHwari.js";import{u as X}from"./useSelectable-BJ_lcm9V.js";import{_ as Y}from"./PageHeader-BnI1hV_t.js";import{_ as ee}from"./Panel-Lw-nuda0.js";import{_ as E}from"./Checkbox-CKdbYkOi.js";import{T as oe,a as te,_ as i}from"./TableCell-C46VQBCN.js";import{_ as se}from"./PureDangerButton-zhKtSmpI.js";import{_ as ae}from"./SelectableBar-CA2MAe5u.js";import{_ as re}from"./Pagination-CB2UcsG3.js";import{_ as ce}from"./NoResult-DNS5zprA.js";import{T as le}from"./Trash-B9tkDRbU.js";import{_ as ne}from"./WebhookItem-DlMlgzZB.js";import"./Flex-0eM5h-qJ.js";import"./ChevronLeft-C0HP3zNo.js";import"./PureButtonLink-hEv16skr.js";import"./DropdownButton-DyMVBGMY.js";import"./EllipsisVertical-DCDthPML.js";import"./QueueList-CJbQdoC3.js";const ie={class:"w-full mx-auto row-py"},de={class:"w-full row-px mt-lg"},me={key:0,class:"mt-lg"},Be={__name:"Index",props:{filter:{type:Object,default:{}},records:{type:Object}},setup(r){const{t:a}=U(),f=r,v=k("routePrefix"),p=k("workspaceCtx"),I=k("confirmation"),{selectedRecords:d,putPageRecords:g,toggleSelectRecordsOnPage:h,deselectRecord:x,deselectAllRecords:$}=X(),{onError:L}=Q(),y=A({keyword:f.filter.keyword}),C=()=>f.records.data.map(s=>s.id),N=()=>{I().title(a("webhook.delete_webhooks")).description(a("webhook.delete_webhooks_confirm")).destructive().onConfirm(s=>{D(s)}).show()},D=s=>{s.isLoading(!0),O.delete(route(`${v}.webhooks.deleteMultiple`,{workspace:p.id}),{data:{webhooks:d.value},preserveScroll:!0,onSuccess(){s.reset(),$()},onError(c){L(c,()=>{D(s)})},onFinish(){s.isLoading(!1)}})};return M(()=>{g(C()),R.on("webhookDeleted",s=>{x(s)})}),W(()=>{R.off("webhookDeleted")}),S(()=>_.cloneDeep(y.value),_.throttle(()=>{O.get(route("mixpost.webhooks.index",{workspace:p.id}),_.pickBy(y.value),{preserveState:!0,only:["records","filter"]})},300)),S(()=>f.records.data,()=>{g(C())}),(s,c)=>{const V=q("tooltip");return n(),w(T,null,[e(o(z),{title:o(a)("webhook.webhooks")},null,8,["title"]),P("div",ie,[e(Y,{title:o(a)("webhook.webhooks")},{description:t(()=>[m(u(o(a)("webhook.webhooks_desc")),1)]),_:1},8,["title"]),P("div",de,[e(o(H),{href:s.route(`${o(v)}.webhooks.create`,{workspace:o(p).id})},{default:t(()=>[e(Z,{size:"sm"},{icon:t(()=>[e(G)]),default:t(()=>[m(" "+u(o(a)("webhook.create_webhook")),1)]),_:1})]),_:1},8,["href"]),e(ae,{count:o(d).length,onClose:o($)},{default:t(()=>[J((n(),b(se,{onClick:N},{default:t(()=>[e(le)]),_:1})),[[V,o(a)("general.delete")]])]),_:1},8,["count","onClose"]),e(ee,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(oe,null,{head:t(()=>[e(te,null,{default:t(()=>[e(i,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(E,{checked:o(h),"onUpdate:checked":c[0]||(c[0]=l=>j(h)?h.value=l:null),disabled:!r.records.meta.total},null,8,["checked","disabled"])]),_:1}),e(i,{component:"th",scope:"col",class:"w-10"}),e(i,{component:"th",scope:"col"},{default:t(()=>[m(u(o(a)("general.name")),1)]),_:1}),e(i,{component:"th",scope:"col"},{default:t(()=>[m(u(o(a)("webhook.callback_url")),1)]),_:1}),e(i,{component:"th",scope:"col"},{default:t(()=>[m(u(o(a)("post.status")),1)]),_:1}),e(i,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(n(!0),w(T,null,K(r.records.data,l=>(n(),b(ne,{key:l.id,item:l,onOnDelete:()=>{o(x)(l.id)}},{checkbox:t(()=>[e(E,{checked:o(d),"onUpdate:checked":c[1]||(c[1]=F=>j(d)?d.value=F:null),value:l.id},null,8,["checked","value"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),r.records.meta.total?B("",!0):(n(),b(ce,{key:0,class:"py-md px-md"}))]),_:1}),r.records.meta.links.length>3?(n(),w("div",me,[e(re,{meta:r.records.meta,links:r.records.links},null,8,["meta","links"])])):B("",!0)])])],64)}}};export{Be as default};
